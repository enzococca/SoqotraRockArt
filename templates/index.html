{% extends "base.html" %}

{% block title %}Dashboard - Soqotra Rock Art Database{% endblock %}

{% block content %}
<h1 class="mb-4">
    <i class="bi bi-speedometer2"></i> Dashboard
</h1>

<!-- Statistics Cards -->
<div class="row mb-4">
    <div class="col-md-4">
        <div class="card text-white bg-primary">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="bi bi-database"></i> Total Records
                </h5>
                <p class="card-text display-4">{{ total_records }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-white bg-success">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="bi bi-images"></i> Total Images
                </h5>
                <p class="card-text display-4">{{ total_images }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-white bg-info">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="bi bi-image-fill"></i> Images per Record
                </h5>
                <p class="card-text display-4">{{ "%.1f"|format(total_images / total_records if total_records > 0 else 0) }}</p>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row mb-4">
    <div class="col-12">
        <h3>Quick Actions</h3>
        <div class="btn-group" role="group">
            <a href="{{ url_for('record_create') }}" class="btn btn-primary">
                <i class="bi bi-plus-circle"></i> New Record
            </a>
            <a href="{{ url_for('records') }}" class="btn btn-outline-primary">
                <i class="bi bi-list-ul"></i> View All Records
            </a>
            <a href="{{ url_for('map_view') }}" class="btn btn-outline-primary">
                <i class="bi bi-map"></i> View Map
            </a>
            <a href="{{ url_for('export_excel') }}" class="btn btn-outline-primary">
                <i class="bi bi-download"></i> Export to Excel
            </a>
        </div>
    </div>
</div>

<!-- Recent Records -->
<div class="row">
    <div class="col-12">
        <h3>Recent Records</h3>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Site</th>
                        <th>Motif</th>
                        <th>Type</th>
                        <th>Images</th>
                        <th>Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in recent_records %}
                    <tr>
                        <td>{{ record.id }}</td>
                        <td>{{ record.site }}</td>
                        <td>{{ record.motif }}</td>
                        <td>{{ record.type or '-' }}</td>
                        <td>
                            <span class="badge bg-secondary">{{ record.images|length }}</span>
                        </td>
                        <td>{{ record.date.strftime('%Y-%m-%d') if record.date else '-' }}</td>
                        <td>
                            <a href="{{ url_for('record_detail', record_id=record.id) }}" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-eye"></i> View
                            </a>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="7" class="text-center text-muted">No records yet. <a href="{{ url_for('record_create') }}">Create your first record</a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
